env:
  - GO111MODULE=on

builds:
- env:
    - CGO_ENABLED=0
  goos:
    - linux
    - darwin
  goarch:
    - amd64
    - arm64
  mod_timestamp: '{{ .CommitTimestamp }}'
  flags:
    - -trimpath
  ldflags:
    - -s -w -X main.version={{.Version}} -X main.commit={{.Commit}} -X main.date={{ .CommitDate }} -X main.builtBy=goreleaser

sboms:
  - artifacts: archive

kos:
  - repository: ghcr.io/timoniersystems/gocobra
    tags:
    - '{{.Version}}'
    - latest
    bare: true
    preserve_import_paths: false
    platforms:
    - linux/amd64
    - linux/arm64
    sbom: spdx

# signs:
# - cmd: cosign
#   certificate: '${artifact}.pem'
#   output: true
#   artifacts: checksum
#   args:
#     - sign-blob
#     - '--output-certificate=${certificate}'
#     - '--output-signature=${signature}'
#     - '${artifact}'
#     - --yes

# docker_signs:
# - cmd: cosign
#   artifacts: manifests
#   output: true
#   args:
#   - 'sign'
#   - '${artifact}@${digest}'
#   - --yes

# yaml-language-server: $schema=https://goreleaser.com/static/schema.json
# vim: set ts=2 sw=2 tw=0 fo=jcroql
